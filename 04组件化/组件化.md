组件设计的关键要素 
- 组件渲染
	- mountComponent - patch
	- updateComponent - patch
- 组件状态与**自更新**
	- 组件渲染函数 作为数据的副作用函数，组件内部状态更新了之后，渲染函数自动执行
	- effect
	- 调度执行 避免一个tick内多次重复渲染
- props与组件的**被动更新**
	- props 是上层父组件的数据，父组件改变数据之后，子组件应该跟着更新，因为是组件外部状态导致的，所以是被动更新
	- props 组件处理props的时候会使用shallowReactive包装一层，这样子组件与props也建立了联系
	- 父组件更新的时候，会对props重新赋值，这时候会触发副作用函数（子组件render函数）执行
- slots 
	- 父级调用组件，注入插槽，以插槽函数的形式，存储在children内
	- 存储在slots属性内  -[?] ？？？
	- 子组件 渲染 调用这些函数
- setup 函数
	- currentInstance getCurrentInstance()
	- 返回对象或者渲染函数
	- 如果返回函数，并且同时有render函数，render函数将被忽略
- emits events 实现
	- 获取传递给子组件所有信息，
	- 过滤emits选项，筛选出事件信息，存储起来
	- 当emit触发的时候，取出对应事件处理函数，执行
- 生命周期钩子注册与调用时机
	- **注册**，调用对应钩子函数，以数组的形式存储在实例对应的生命周期属性上
	- **调用** 在组件patch前后 从currentInstance实例里面获取对应的钩子函数数组，然后依次调用
- context
	- ctx 组件instance proxy代理对象

组件选项对象
type

组件vDom：
vnode

组件实例： 
instance 
currentInstance


有一个**renderContext**对象
是对实例的一个proxy ？？？


## 异步组件

### 应用场景
代码拆分、延迟加载

### 自定义实现

自定义实现组件异步渲染
利用**动态导入import**函数

### Vue实现
Vue框架层面包装完善异步加载组件流程，允许用户设置兜底策略和增加一些体验优化
+ 允许用户指定加载出错时兜底渲染组件
+ 允许自定义loading组件，以及loading组件展示的延迟时间
+ 允许设置加载组件的超时时长
+ 失败重试

## 函数式组件

本质是一个普通函数， **返回值是虚拟DOM**
函数直接作为组件的render函数

没有内部状态，初始化性能小于有状态组件


## 内建组件

### KeepAlive
用在组件会被频繁的显示、隐藏场景，避免组件频繁的销毁、重建

原理是组件隐藏时，将组件从原容器搬运到另一个隐藏的容器中，实现假卸载；当组件需要再次被挂载时，将组件从隐藏容器中搬运到原容器内

**缓存管理**
LRU 策略，缓存有阈值
### Teleport
组件跨DOM层级渲染

### Transition